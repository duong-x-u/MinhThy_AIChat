<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chat vá»›i Minh Thy ğŸŒ¸</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="dark-theme">
    <div class="app-wrapper">
        <!-- Sidebar - Conversations -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>ğŸ’¬ Chats</h2>
                <button class="btn-icon" id="newChatBtn" title="Táº¡o chat má»›i">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                </button>
            </div>
            <div class="conversation-list" id="conversationList">
                <!-- Conversations rendered here -->
            </div>
            <div class="sidebar-footer">
                <button class="btn-icon" id="themeToggle" title="Äá»•i theme">
                    <svg class="icon-sun" viewBox="0 0 24 24" fill="currentColor"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/></svg>
                    <svg class="icon-moon" viewBox="0 0 24 24" fill="currentColor"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/></svg>
                </button>
                <button class="btn-icon" id="soundToggle" title="Ã‚m thanh">
                    <svg class="icon-sound-on" viewBox="0 0 24 24" fill="currentColor"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
                    <svg class="icon-sound-off" viewBox="0 0 24 24" fill="currentColor"><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/></svg>
                </button>
            </div>
        </aside>

        <!-- Main Chat Area -->
        <div class="app-container">
            <!-- Header -->
            <header class="chat-header">
                <button class="btn-icon mobile-menu" id="menuToggle">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
                </button>
                <div class="header-left">
                    <div class="avatar">
                        <span class="avatar-letter" id="avatarLetter">T</span>
                        <span class="online-dot"></span>
                    </div>
                    <div class="contact-info">
                        <h1 class="contact-name" id="aiNickname">Minh Thy</h1>
                        <p class="contact-status" id="statusText">Äang hoáº¡t Ä‘á»™ng</p>
                    </div>
                </div>
                <div class="header-right">
                    <button class="btn-icon" id="searchBtn" title="TÃ¬m kiáº¿m">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                    </button>
                    <button class="btn-icon" id="exportBtn" title="Xuáº¥t chat">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                    </button>
                    <button class="btn-icon" id="settingsBtn" title="CÃ i Ä‘áº·t">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
                    </button>
                </div>
            </header>

            <!-- Search Bar -->
            <div class="search-bar" id="searchBar">
                <input type="text" id="searchInput" placeholder="TÃ¬m kiáº¿m tin nháº¯n...">
                <button class="btn-icon" id="closeSearch">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>

            <!-- Search Results -->
            <div class="search-results" id="searchResults"></div>

            <!-- Chat Messages -->
            <main class="chat-area" id="chatArea">
                <div class="chat-start-message">
                    <div class="start-avatar">ğŸŒ¸</div>
                    <p>Báº¯t Ä‘áº§u cuá»™c trÃ² chuyá»‡n vá»›i <strong id="startName">Minh Thy</strong></p>
                    <span class="start-hint">Lá»‹ch sá»­ chat Ä‘Æ°á»£c lÆ°u tá»± Ä‘á»™ng</span>
                </div>
            </main>

            <!-- Scroll to bottom button -->
            <button class="scroll-bottom-btn" id="scrollBottomBtn" title="Cuá»™n xuá»‘ng">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
            </button>

            <!-- Typing Indicator -->
            <div class="typing-indicator" id="typingIndicator">
                <div class="typing-avatar">
                    <span>T</span>
                </div>
                <div class="typing-content">
                    <span></span><span></span><span></span>
                </div>
            </div>

            <!-- Reply Preview -->
            <div class="reply-preview" id="replyPreview">
                <div class="reply-info">
                    <span class="reply-label">Äang tráº£ lá»i <strong id="replySender"></strong></span>
                    <p class="reply-text" id="replyText"></p>
                </div>
                <button class="btn-icon" id="cancelReply">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>

            <!-- Input Area -->
            <footer class="input-area">
                <button class="btn-icon" id="emojiBtn" title="Emoji">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/></svg>
                </button>
                
                <!-- Emoji Picker -->
                <div class="emoji-picker" id="emojiPicker">
                    <div class="emoji-grid">
                        <span>ğŸ˜€</span><span>ğŸ˜‚</span><span>ğŸ¥°</span><span>ğŸ˜</span><span>ğŸ¤©</span>
                        <span>ğŸ˜</span><span>ğŸ¤”</span><span>ğŸ˜…</span><span>ğŸ˜­</span><span>ğŸ˜¤</span>
                        <span>ğŸ¥º</span><span>ğŸ˜³</span><span>ğŸ™„</span><span>ğŸ˜</span><span>ğŸ˜´</span>
                        <span>ğŸ¤—</span><span>ğŸ¤­</span><span>ğŸ¤«</span><span>ğŸ˜±</span><span>ğŸ¤¡</span>
                        <span>ğŸ‘</span><span>ğŸ‘</span><span>ğŸ‘</span><span>ğŸ™</span><span>ğŸ’ª</span>
                        <span>â¤ï¸</span><span>ğŸ’”</span><span>ğŸ’•</span><span>âœ¨</span><span>ğŸ”¥</span>
                        <span>ğŸŒ¸</span><span>ğŸŒ¹</span><span>ğŸ‰</span><span>ğŸŠ</span><span>ğŸ¥³</span>
                        <span>ğŸ’€</span><span>ğŸ‘»</span><span>ğŸ¤–</span><span>ğŸ‘€</span><span>ğŸ’©</span>
                    </div>
                </div>
                
                <div class="input-wrapper">
                    <textarea 
                        id="messageInput" 
                        placeholder="Aa"
                        rows="1"
                        maxlength="2000"
                    ></textarea>
                </div>
                <button class="send-btn" id="sendBtn">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
                </button>
            </footer>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <div class="modal-header">
                <h2>âš™ï¸ CÃ i Ä‘áº·t cuá»™c trÃ² chuyá»‡n</h2>
                <button class="close-btn" id="closeSettings">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="setting-item">
                    <label>TÃªn cuá»™c trÃ² chuyá»‡n</label>
                    <input type="text" id="convNameInput" maxlength="30">
                </div>
                <div class="setting-item">
                    <label>TÃªn AI</label>
                    <input type="text" id="aiNameInput" maxlength="20">
                </div>
                <div class="setting-item">
                    <label>TÃªn cá»§a báº¡n</label>
                    <input type="text" id="userNameInput" maxlength="20">
                </div>
                <div class="setting-item">
                    <label>ğŸ­ Mood cá»§a AI: <span id="moodValue">70</span>%</label>
                    <input type="range" id="moodSlider" min="0" max="100" value="70">
                    <div class="mood-labels">
                        <span>ğŸ˜ Tráº§m</span>
                        <span>ğŸ˜Š Vui</span>
                        <span>ğŸ¤ª NhÃ¢y</span>
                    </div>
                </div>
                <div class="setting-item">
                    <label>Sá»‘ tin nháº¯n</label>
                    <p class="setting-value" id="messageCount">0</p>
                </div>
                <div class="setting-item danger">
                    <button class="btn-danger" id="deleteConvBtn">ğŸ—‘ï¸ XoÃ¡ cuá»™c trÃ² chuyá»‡n nÃ y</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-save" id="saveSettings">LÆ°u thay Ä‘á»•i</button>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div class="modal-overlay" id="exportModal">
        <div class="modal modal-small">
            <div class="modal-header">
                <h2>ğŸ“¤ Xuáº¥t lá»‹ch sá»­ chat</h2>
                <button class="close-btn" id="closeExport">Ã—</button>
            </div>
            <div class="modal-body">
                <button class="btn-export" id="exportTxt">ğŸ“„ Xuáº¥t file .txt</button>
                <button class="btn-export" id="exportJson">ğŸ“‹ Xuáº¥t file .json</button>
            </div>
        </div>
    </div>

    <!-- Reaction Picker -->
    <div class="reaction-picker" id="reactionPicker">
        <span data-emoji="â¤ï¸">â¤ï¸</span>
        <span data-emoji="ğŸ˜‚">ğŸ˜‚</span>
        <span data-emoji="ğŸ˜®">ğŸ˜®</span>
        <span data-emoji="ğŸ˜¢">ğŸ˜¢</span>
        <span data-emoji="ğŸ˜¡">ğŸ˜¡</span>
        <span data-emoji="ğŸ‘">ğŸ‘</span>
    </div>

    <!-- Audio -->
    <audio id="notificationSound" preload="auto">
        <source src="https://assets.mixkit.co/active_storage/sfx/2354/2354-preview.mp3" type="audio/mpeg">
    </audio>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>